@{
    ViewBag.Title = "IGR Payment List";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<div class="content">





    @using (Html.BeginForm("EditIGRRemita", "Admin", FormMethod.Post))
    {
        <div class="modal fade EditUsermodal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="calenderModalLabel">
            <div class="modal-dialog modal" style="display:inline-block; margin:0 auto 0 25%; overflow-y:hidden; overflow-x:hidden; margin-top:100px; width:50%" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title text-success" id="exampleModalLabel"><span class="glyphicon glyphicon-hand-down"></span> Edit User</h4>
                    </div>

                    <div class="modal-body">
                        <div class="form-horizontal">
                            <div class="container">
                                <div class="row">

                                    <div class="col-sm-4">
                                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                                        <input type="hidden" class="Appid" id="Appid" name="Appid" />
                                        <div><label>RRR</label></div>
                                        <div class="form-group">
                                            <div class="col-md-10">
                                                <input type="text" id="rrr" name="rrr" class="form-control rrr" />
                                            </div>
                                        </div>



                                        <div><label>Amount</label></div>
                                        <div class="form-group">
                                            <div class="col-md-10">
                                                <input type="text" id="amount" name="amount" class="form-control amount" />
                                            </div>
                                        </div>


                                        <div class="form-group">
                                            <div class="col-md-10">
                                                <input type="submit" value="Save Update" class="btn btn-success" />
                                            </div>
                                        </div>
                                    </div>
                                    <br />
                                   
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    }








    <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel">
                        <header class="panel-heading panel-border">
                            <h3 class="text-primary">IGR Payment Report </h3>

                            <div class="pull-right" style="margin-right:25px">
                                <div class="row">

                                    <div class="col-md-12">
                                        <div class="panel short-states" style="background-color:#eaeef3; margin-right:50px">
                                            <div class="panel-title">
                                            </div>
                                            <div class="panel-body">
                                                <h1><span class="col-md-offset-1 text-danger">@TempData["totaligrpaymentcount"] </span></h1>
                                                <small class="label label-danger" style="font-size:15px">Total Count</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </header>
                        <div class="panel-body">

                            <div style="margin-top:-50px" class="col-md-12">
                                <table class="table table-striped table-bordered" id="payment" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th><strong>Reference ID</strong>
                                            <th><strong>Remita Ref</strong> </th>
                                            <th><strong>Payment Type</strong> </th>
                                            <th><strong>Company Name</strong> </th>
                                            <th><strong>Company Email</strong> </th>
                                            <th><strong>Service Charge</strong> </th>
                                            <th><strong>Charged Amount</strong> </th>
                                            <th><strong>Total Amount</strong> </th>
                                            <th><strong>Transaction Date</strong> </th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                    <tfoot>
                                        <tr>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                           

                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div><br /><br /><br />


                       

                        <div class="panel-body">

                            <div style="margin-top:-50px" class="col-md-12">
                                <table class="table table-striped table-bordered" id="payment1" style="font-size:small">
                                    <thead>
                                        <tr>
                                            <th><strong>ApplicationID</strong>
                                            <th><strong>Remita Ref</strong> </th>
                                            <th><strong>Payment Type</strong> </th>
                                            <th><strong>Company Name</strong> </th>
                                            <th><strong>Company Email</strong> </th>
                                            <th><strong>Processing Fee</strong> </th>
                                            <th><strong>Service Charge</strong> </th>
                                            <th><strong>Total Amount</strong> </th>
                                            <th><strong>Transaction Date</strong> </th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                    <tfoot>
                                        <tr>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>






                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="jumbotron">
        <div id="container" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto">
            <div class="panel short-states">
                <div class="panel-title">
                </div>
                <div class="panel-body img-circle" style="border-radius:100%">
                    <div text-danger" style="font-size:20px"><img src="~/Images/Nigerian-Naira.png" />@TempData["IgrSumtotalpayment"]</div><br />
                    <small class="label label-danger" style="font-size:15px">Total Payment</small>
                </div>
            </div>

        </div>
    </div>
</div>
@section Scripts {

    <script type="text/javascript">
        $(document).ready(function () {
            $(".all").click(function () {
                table.search("All Payment").draw();
            });
            $("#searchdate").click(function () {
                min1 = $(".min").val();
                datemax1 = $(".maxdate").val();
                table.draw();
            });
            var table = $("#payment").DataTable({
                "processing": true,
                "serverSide": true,
                //"search": { "search": "Default_filter" },
                ajax: {
                    url: "/Admin/GetIGRPaymentReport",
                    type: "POST",
                    data: function (d) {
                        debugger;
                        d.mymin = $("#min").val();
                        d.mymax = $("#maxdate").val();
                    },
                    "lengthMenu": [[10, 25, 50, 100], [10, 25, 50, 100]],

                },
                //sDom: 'Blrtip',
                dom: 'Blfrtip',
                columns: [
                    {
                        data: "ExtraPaymentAppRef"
                    },
                    {
                        data: "RRReference"
                    },
                    {
                        data: "category"
                    },
                    {
                        data: "companyname"
                    },
                    {
                        data: "companyemail"
                    },

                    
                    {
                        data: "servicecharge"
                    },
                    {
                        data: "amt",

                    },
                    {
                        data: "totamt",

                    },
                    
                    {
                        data: "transdate",

                    },
                ],


                "columnDefs": [

                    {
                        "targets": 9,
                        "data": null,
                        "render": function (data, type, row) {
                            var role = '@ViewBag.LoginUsersId';
                            return role === "SUPERADMIN"? '<span id="EditUsers" class="btn btn-xs btn-primary EditUsers"><span class="glyphicon glyphicon-edit"></span>  Edit</span>':'';

                        }
                    },


                ],




                "footerCallback": function (row, data, start, end, display) {
                    var api = this.api(), data;

                    // Remove the formatting to get integer data for summation
                    var intVal = function (i) {
                        return typeof i === 'string' ?
                            i.replace(/[\$,]/g, '') * 1 :
                            typeof i === 'number' ?
                                i : 0;
                    };

                    // Total over this page
                    pageTotal = api
                        .column(7, { filter: 'applied' })
                        .data()
                        .reduce(function (a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Update footer
                    debugger;
                    $(api.column(7).footer()).html(
                        'Total Per Page= ' + '₦' + pageTotal

                    );


                }
            });



            $(".all1").click(function () {
                table.search("All Payment").draw();
            });
            $("#searchdate1").click(function () {
                min1 = $(".min1").val();
                datemax1 = $(".maxdate1").val();
                table.draw();
            });








            var table1 = $("#payment1").DataTable({
                "processing": true,
                "serverSide": true,
                ajax: {
                    url: "/Admin/GetIGRPaymentReport1",
                    type: "POST",
                    data: function (d) {
                        debugger;
                        d.mymin1 = $("#min1").val();
                        d.mymax1 = $("#maxdate1").val();
                    },
                    "lengthMenu": [[10, 25, 50, 100], [10, 25, 50, 100]],

                },
                dom: 'Blfrtip',
                columns: [
                    {
                        data: "ApplicationId"
                    },
                    {
                        data: "RRReference"
                    },
                    {
                        data: "category"
                    },
                    {
                        data: "companyname"
                    },
                    {
                        data: "companyemail"
                    },
                    {
                        data: "processingfee"
                    },
                    {
                        data: "servicecharge"
                    },

                    {
                        data: "amt",

                    },
                    {
                        data: "transdate",

                    },
                ],


                 "columnDefs": [

                    {
                        "targets": 9,
                        "data": null,
                        "render": function (data, type, row) {
                            var role = '@ViewBag.LoginUsersId';
                            return role === "SUPERADMIN"? '<button id="EditUsers" class="btn btn-xs btn-primary EditUsers"><span class="glyphicon glyphicon-edit"></span>  Edit</button>':'';

                        }
                    },


                ],


                "footerCallback": function (row, data, start, end, display) {
                    var api = this.api(), data;

                    // Remove the formatting to get integer data for summation
                    var intVal = function (i) {
                        return typeof i === 'string' ?
                            i.replace(/[\$,]/g, '') * 1 :
                            typeof i === 'number' ?
                                i : 0;
                    };

                    // Total over this page
                    pageTotal = api
                        .column(7, { filter: 'applied' })
                        .data()
                        .reduce(function (a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Update footer
                    debugger;
                    $(api.column(7).footer()).html(
                        'Total Per Page= ' + '₦' + pageTotal

                    );


                }
            });




            $("#payment").on('click',
                'span',
                function () {
                    debugger;
                    $(".EditUsermodal").modal('show');
                    $(".DeactivateUser").modal('hide');
                    $(".ActivateUser").modal('hide');
                    var data = table.row($(this).parents('tr')).data();
                    $(".amount").val(data.amt);
                    $(".rrr").val(data.RRReference);
                    $(".Appid").val(data.ExtraPaymentAppRef);

                });


            $("#payment1").on('click',
                'button',
                function () {
                    $(".EditUsermodal").modal('show');
                    $(".DeactivateUser").modal('hide');
                    $(".ActivateUser").modal('hide');
                    var data = table1.row($(this).parents('tr')).data();

                    $(".amount").val(data.amt);
                    $(".rrr").val(data.RRReference);
                    $(".Appid").val(data.ApplicationId);
                });


        });


        window.setInterval(function () {
            $('#payment').DataTable().ajax.reload();
        }, 30000);



        window.setInterval(function () {
            $('#payment1').DataTable().ajax.reload();
        }, 30000);


        function numberToWords(number) {
            var digit = ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
            var elevenSeries = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
            var countingByTens = ['twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
            var shortScale = ['', 'thousand', 'million', 'billion', 'trillion'];

            number = number.toString(); number = number.replace(/[\, ]/g, ''); if (number != parseFloat(number)) return 'not a number'; var x = number.indexOf('.'); if (x == -1) x = number.length; if (x > 15) return 'too big'; var n = number.split(''); var str = ''; var sk = 0; for (var i = 0; i < x; i++) { if ((x - i) % 3 == 2) { if (n[i] == '1') { str += elevenSeries[Number(n[i + 1])] + ' '; i++; sk = 1; } else if (n[i] != 0) { str += countingByTens[n[i] - 2] + ' '; sk = 1; } } else if (n[i] != 0) { str += digit[n[i]] + ' '; if ((x - i) % 3 == 0) str += 'hundred '; sk = 1; } if ((x - i) % 3 == 1) { if (sk) str += shortScale[(x - i - 1) / 3] + ' '; sk = 0; } } if (x != number.length) { var y = number.length; str += 'point '; for (var i = x + 1; i < y; i++) str += digit[n[i]] + ' '; } str = str.replace(/\number+/g, ' '); return str.trim() + ".";

        }

    </script>
}
